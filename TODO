remove nested callbacks in favor of Q node calls

get tests really working
